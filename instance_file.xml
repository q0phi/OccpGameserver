<?xml version="1.0" encoding="UTF-8"?>
<occpchallenge>
    <!-- Describe the current scenario; instance data can ovveride this section -->
    <scenario>
        <gameid id="1" />
        <name>Red Team vs. Blue Team</name>
        <type>Network Defense</type>
        <description>Blue team defends the network against automated Red team attacks. This scenario focuses on protecting against weak passwords and unused services.</description>

        <!-- Length of time to run this scenario -->
        <length format="hh:mm:ss"
                time="00:30:00" />

        <!-- Recommended virtual target network -->
        <networkid number="1" />

        <users>
            <user name="moderator" pass="token"/>
            <user name="blueplayer" pass="token"/>
            <user name="spectator" pass="token"/>
        </users>

        <!-- When a user logs in to the system the components that are displayed are 
             defined in these sections -->
        <user-interfaces>
            <user-interface name="spectator-ui"
                            show-scoreboard="true"
                            show-teams-all="false"
                            show-other-controls="false">
                <scoreboard name="spectator-board" />
                <permitted-users>
                    <user name="spectator" />
                </permitted-users>    
            </user-interface>
            <user-interface name="moderator-ui"
                            show-scoreboard="true"
                            show-teams-all="true"
                            show-other-controls="true">
                <scoreboard name="moderator-board" />
                <permitted-users>
                    <user name="moderator" />
                </permitted-users>    
            </user-interface>
        </user-interfaces>
        
        <!-- Score groups allow certain events to be grouped together for score calculation -->
        <score-groups>
            <score-group name="group1" />
            <score-group name="group2" />
            <score-group name="group3" />
            <score-group name="group4" />
            <score-group name="group5" />
        </score-groups>
        
        <!-- Scoreboard show a particular calculation of a group of scores -->
        <scoreboards>
            <scoreboard name="moderator-board" update-rate="live">
                <score name="Red Team">{$group1 + $group2 + $group3}</score>
                <score name="Blue Team">{$group4 + $group5 - $group3}</score>
                <score name="Service Level">{$group1 + $group2 + $group5}</score>
            </scoreboard>
            <scoreboard name="spectator-board" update-rate="live">
                <score name="Red Team">{$group1 + $group2 + $group3}</score>
                <score name="Blue Team">{$group4 + $group5 - $group3}</score>
                <score name="Service Level">{$group1 + $group2 + $group5}</score>
            </scoreboard>
            <scoreboard name="player-board" update-rate="1min">
                <score name="Red Team">{$group1 + $group2 + $group3}</score>
                <score name="Blue Team">{$group4 + $group5 - $group3}</score>
                <score name="Service Level">{$group1 + $group2 + $group5}</score>
            </scoreboard>
        </scoreboards>


    </scenario>

    <!-- Instance data overrides the scenario section -->
    <instance>    
        <length format="hh:mm:ss">00:30:00</length>
    </instance>

    <!-- Identify the handlers needed to run events -->
    <event-handlers>

        <handler name="exec-handler-1" 
                 class-handler="exec-handler" />
        <handler name="metasploit-handler-1"
                 class-handler="metasploit-handler"
                 server-hostname="host1"
                 server-ip=""
                 server-port="" />

        <!-- More than one location could be used to launch events -->
        <handler name="metasploit-handler-2"
                 class-handler="metasploit-handler"
                 server-hostname="host2"
                 server-ip=""
                 server-port="" />

    </event-handlers>

    <!-- Identify each location that team processes will execute.
         Each of these locations needs to be contacted to dispatch the appropriate team code to. -->
    <team-locations>
        <team-runner name="Local"
                     hostname="localhost"
                     ip-addr="127.0.0.1"
                     port="24365" />
        <team-runner name="RemoteHost1"
                     hostname="RemoteHostName"
                     ip-addr="0.0.0.0"
                     port="24365" />
    </team-locations>

    <team name="TEMPLATE">
    
        <!-- Identifies the name of the location to dispatch this team to -->
        <team-runner name="Local" />
        
        <!-- Time to begin and end list execution relative to the game clock -->
        <starttime format="hh:mm:ss">00:00:00</starttime>
        <endtime format="hh:mm:ss">99:99:99</endtime>
        
        <!-- Rate at which events are executed from the event list -->
        <speed factor="1.0" />
        
        <!-- Parent block for events in this teams event list -->
        <team-event-list>
            <team-event>
                <name>TEMPLATE</name>
                <event-id id="" />
                <!-- The name of a named handler in the <event-handlers> list to dispatch this event to -->
                <handler name="exec-handler-1|metasploit-handler-1|metasploit-handler-2" />
                <handler-event-id guid="" />
                <!-- Time to begin and end execution relative to the game clock -->
                <starttime format="hh:mm:ss">00:00:00</starttime>
                <endtime format="hh:mm:ss">99:99:99</endtime>
                <!-- Possible rates include sec|min|hour;
                     drift [0.0 - 1.0] create semi-random event executions -->
                <rate scale="min">5</rate>
                <drift>0.0</drift>
                <!-- Submit scores to the identified groups -->
                <score-atomic score-group="group1" points="5" />
                <score-atomic score-group="group2" points="-3" />
                <!-- Event specific parameters -->
                <parameters>
                    <param>

                    </param>
                </parameters>
            </team-event>

        </team-event-list>
    </team>

</occpchallenge>
