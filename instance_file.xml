<?xml version="1.0" encoding="UTF-8"?>
<occpchallenge>
    <!-- Describe the current scenario; instance data can ovveride this section -->
    <scenario>
        <gameid id="1" />
        <name>Red Team vs. Blue Team</name>
        <type>Network Defense</type>
        <description>Blue team defends the network against automated Red team attacks. This scenario focuses on protecting against weak passwords and unused services.</description>

        <!-- Length of time to run this scenario -->
        <length format="minutes"
                time="30" />

        <!-- Recommended virtual target network -->
        <networkid number="1" />

        <users>
            <user name="moderator" pass="token"/>
            <user name="blueplayer" pass="token"/>
            <user name="spectator" pass="token"/>
        </users>

        <!-- When a user logs in to the system the components that are displayed are 
             defined in these sections -->
        <user-interfaces>
            <user-interface name="spectator-ui"
                            show-scoreboard="true"
                            show-teams-all="false"
                            show-other-controls="false">
                <scoreboard name="spectator-board" />
                <permitted-users>
                    <user name="spectator" />
                </permitted-users>    
            </user-interface>
            <user-interface name="moderator-ui"
                            show-scoreboard="true"
                            show-teams-all="true"
                            show-other-controls="true">
                <scoreboard name="moderator-board" />
                <permitted-users>
                    <user name="moderator" />
                </permitted-users>    
            </user-interface>
        </user-interfaces>
        
        <!-- Score groups labels allow certain events to be grouped together for score calculation -->
        <!--  -->
        <score-labels>
            <score-label name="group1" select="SUM(value)" where="groupname='group1' AND time > (time('now') - 30)"/>
            <score-label name="group2" sql="SELECT SUM(value) FROM SCORE WHERE groupname='group2' AND time > (time('now') - 300)"/>
            <score-label name="group3" />
            <score-label name="group4" sql='SELECT SUM(value) FROM SCORE WHERE groupname="group4"'/>
            <score-label name="group5" /> 
        </score-labels>

        <score-names>
                <!-- score names are treated as ERb templates; use score labels as variables in calculation-->
                <score-name name="red-team" descr="Red Team" formula="group1 - group2 + group3" />
                <score-name name="blue-team" descr="Blue Team" formula="group4 + group5 - group3" />
                <score-name name="service-level" descr="Service Level" formula="group1 + group2 + group5" />
        </score-names>

        <!-- Scoreboard show a particular calculation of a group of scores -->
        <scoreboards>
            <scoreboard name="moderator-board" update-rate="live">
                <score-name name="red-team" />
                <score-name name="blue-team" />
                <score-name name="service-level" />
            </scoreboard>
            <scoreboard name="spectator-board" update-rate="live">
                <score-name name="red-team" />
                <score-name name="blue-team" />
                <score-name name="service-level" />
            </scoreboard>
            <scoreboard name="player-board" update-rate="1min">
                <score-name name="red-team" />
                <score-name name="blue-team" />
                <score-name name="service-level" />
            </scoreboard>
        </scoreboards>


    </scenario>

    <!-- Instance data overrides the scenario section -->
    <instance>    
        <length format="seconds">00:30:00</length>
    </instance>

    <!-- Identify each location that team processes will execute.
         Each of these locations needs to be contacted to dispatch the appropriate team code to. 
         These hosts need to specified in the host section. -->
    <team-hosts>
        <team-host name="Local"
                     hostname="localhost"
                     ip-addr="127.0.0.1"
                     port="24365" />
        <team-host name="RemoteHost1"
                     hostname="RemoteHostName"
                     ip-addr="0.0.0.0"
                     port="24365" />
    </team-hosts>
   
    <!-- Identify the handlers needed to run events -->
    <event-handlers>

        <handler name="exec-handler-1" 
                 class-handler="ExecHandler" />
        <handler name="metasploit-handler-1"
                 class-handler="MetasploitHandler"
                 server-hostname="host1"
                 server-ip=""
                 server-port="" />

        <!-- More than one location could be used to launch events 
        <handler name="metasploit-handler-2"
                 class-handler="metasploit-handler"
                 server-hostname="host2"
                 server-ip=""
                 server-port="" /> -->

    </event-handlers>

    <team name="Blue Team">
    
        <!-- Identifies the name of the location to dispatch this team to -->
        <team-host hostname="localhost" />
              
        <!-- Rate at which events are executed from the event list -->
        <speed factor="1.0" />
        
        <!-- Parent block for events in this teams event list -->
        <team-event-list>
            <team-event>
                <event-name name="Exec Test" />
                <event-id id="" />
                <!-- The name of a named handler in the <event-handlers> list to dispatch this event to -->
                <handler name="exec-handler-1" />
                <handler-event-id guid="" />
                <!-- Time to begin and end execution relative to the game clock -->
                <starttime format="seconds" time="5" />
                <endtime format="seconds" time="9999999" />
                <!-- Possible rates include sec|min|hour;
                     drift [0.0 - 1.0] create semi-random event executions -->
                <rate scale="none" value="1" />
                <drift value="0.0" />
                <!-- Submit scores to the identified groups -->
                <score-atomic when="success" score-group="group1" points="5" />
                <score-atomic when="fail" score-group="group2" points="-3" />
                <!-- Event specific parameters -->
                <parameters>
                    <param name="command" value="ping -c 1 127.0.0.1" />
                </parameters>
                <command value="ping -c 1 127.0.0.1" />
            </team-event>
            <team-event>
                <command value="ping -c 1 127.0.0.3" />
                <event-name name="Ping" />
                <event-id id="" />
                <!-- The name of a named handler in the <event-handlers> list to dispatch this event to -->
                <handler name="exec-handler-1" />
                <handler-event-id guid="" />
                <!-- Time to begin and end execution relative to the game clock -->
                <starttime format="seconds" time="0" />
                <endtime format="seconds" time="9999999" />
                <!-- Possible rates include sec|min|hour;
                     drift [0.0 - 1.0] create semi-random event executions -->
                <rate scale="sec" value="1" />
                <drift value="0.0" />
                <!-- Submit scores to the identified groups -->
                <score-atomic score-group="group1" points="5" />
                <score-atomic score-group="group2" points="-3" />
                <!-- Event specific parameters -->
                <parameters>
                    <param name="host" value="127.0.0.1" />
                    <param name="count" value="15" />
                </parameters>
            </team-event>
            <team-event>
                <event-name name="FTP Attack" />
                <event-id id="" />
                <!-- The name of a named handler in the <event-handlers> list to dispatch this event to -->
                <handler name="metasploit-handler-1" />
                <handler-event-id guid="" />
                <!-- Time to begin and end execution relative to the game clock -->
                <starttime format="seconds" time="0" />
                <endtime format="seconds" time="9999999" />
                <!-- Possible rates include sec|min|hour;
                     drift [0.0 - 1.0] create semi-random event executions -->
                <rate scale="sec" value="1" />
                <drift value="0.0" />
                <!-- Submit scores to the identified groups -->
                <score-atomic score-group="group1" points="5" />
                <score-atomic score-group="group2" points="-3" />
                <!-- Event specific parameters -->
                <parameters>
                    <param name="host" value="10.0.0.6" />
                    <param name="port" value="22" />
                    <param name="credentials">
                    </param>
                </parameters>
            </team-event>
            <team-event>
                <command value="ping -c 1 127.0.0.10" />
                <event-name name="Ping" />
                <event-id id="" />
                <!-- The name of a named handler in the <event-handlers> list to dispatch this event to -->
                <handler name="exec-handler-1" />
                <handler-event-id guid="" />
                <!-- Time to begin and end execution relative to the game clock -->
                <starttime format="seconds" time="10" />
                <endtime format="seconds" time="9999999" />
                <!-- Possible rates include sec|min|hour;
                     drift [0.0 - 1.0] create semi-random event executions -->
                <rate scale="none" value="5" />
                <drift value="0.0" />
                <!-- Submit scores to the identified groups -->
                <score-atomic score-group="group1" points="5" />
                <score-atomic score-group="group2" points="-3" />
                <!-- Event specific parameters -->
                <parameters>
                    <param name="host" value="127.0.0.1" />
                    <param name="count" value="15" />
                </parameters>
            </team-event>
            <team-event>
                <event-name name="FTP Attack" />
                <event-id id="" />
                <!-- The name of a named handler in the <event-handlers> list to dispatch this event to -->
                <handler name="metasploit-handler-1" />
                <handler-event-id guid="" />
                <!-- Time to begin and end execution relative to the game clock -->
                <starttime format="seconds" time="0" />
                <endtime format="seconds" time="9999999" />
                <!-- Possible rates include sec|min|hour;
                     drift [0.0 - 1.0] create semi-random event executions -->
                <rate scale="none" value="1" />
                <drift value="0.0" />
                <!-- Submit scores to the identified groups -->
                <score-atomic score-group="group1" points="5" />
                <score-atomic score-group="group2" points="-3" />
                <!-- Event specific parameters -->
                <parameters>
                    <param name="host" value="10.0.0.6" />
                    <param name="port" value="22" />
                    <param name="credentials">
                    </param>
                </parameters>
            </team-event>
           
        </team-event-list>
    </team>
    <team name="Red Team">
    
        <!-- Identifies the name of the location to dispatch this team to -->
        <team-host hostname="localhost" />
              
        <!-- Rate at which events are executed from the event list -->
        <speed factor="1.0" />
        
        <!-- Parent block for events in this teams event list -->
        <team-event-list>
            <team-event>
                <command value="ping -c 1 131.128.81.80" />
                <event-name name="Ping" />
                <event-id id="" />
                <!-- The name of a named handler in the <event-handlers> list to dispatch this event to -->
                <handler name="exec-handler-1" />
                <handler-event-id guid="" />
                <!-- Time to begin and end execution relative to the game clock -->
                <starttime format="seconds" time="0" />
                <endtime format="seconds" time="9999999" />
                <!-- Possible rates include sec|min|hour;
                     drift [0.0 - 1.0] create semi-random event executions -->
                <rate scale="min" value="30" />
                <drift value="0.0" />
                <!-- Submit scores to the identified groups -->
                <score-atomic when="fail" score-group="group1" points="5" />
                <score-atomic score-group="group2" points="-3" />
                <!-- Event specific parameters -->
                <parameters>
                    <param name="host" value="127.0.0.1" />
                    <param name="count" value="15" />
                </parameters>
            </team-event>
            <team-event>
                <command value="ping -c 1 127.0.0.1" />
                <event-name name="Ping" />
                <event-id id="" />
                <!-- The name of a named handler in the <event-handlers> list to dispatch this event to -->
                <handler name="exec-handler-1" />
                <handler-event-id guid="" />
                <!-- Time to begin and end execution relative to the game clock -->
                <starttime format="seconds" time="0" />
                <endtime format="seconds" time="9999999" />
                <!-- Possible rates include sec|min|hour;
                     drift [0.0 - 1.0] create semi-random event executions -->
                <rate scale="min" value="5" />
                <drift value="0.0" />
                <!-- Submit scores to the identified groups -->
                <score-atomic score-group="group1" points="5" />
                <score-atomic score-group="group2" points="-3" />
                <!-- Event specific parameters -->
                <parameters>
                    <param name="host" value="127.0.0.1" />
                    <param name="count" value="15" />
                </parameters>
            </team-event>
            <team-event>
                <event-name name="FTP Attack" />
                <event-id id="" />
                <!-- The name of a named handler in the <event-handlers> list to dispatch this event to -->
                <handler name="metasploit-handler-1" />
                <handler-event-id guid="" />
                <!-- Time to begin and end execution relative to the game clock -->
                <starttime format="seconds" time="10" />
                <endtime format="seconds" time="9999999" />
                <!-- Possible rates include sec|min|hour;
                     drift [0.0 - 1.0] create semi-random event executions -->
                <rate scale="none" value="1" />
                <drift value="0.0" />
                <!-- Submit scores to the identified groups -->
                <score-atomic score-group="group1" points="5" />
                <score-atomic score-group="group2" points="-3" />
                <!-- Event specific parameters -->
                <parameters>
                    <param name="host" value="10.0.0.6" />
                    <param name="port" value="22" />
                    <param name="credentials">
                    </param>
                </parameters>
            </team-event>
            <team-event>
                <command value="pangalo" />
                <event-name name="Ping" />
                <event-id id="" />
                <!-- The name of a named handler in the <event-handlers> list to dispatch this event to -->
                <handler name="exec-handler-1" />
                <handler-event-id guid="" />
                <!-- Time to begin and end execution relative to the game clock -->
                <starttime format="seconds" time="13" />
                <endtime format="seconds" time="9999999" />
                <!-- Possible rates include sec|min|hour;
                     drift [0.0 - 1.0] create semi-random event executions -->
                <rate scale="none" value="1" />
                <drift value="0.0" />
                <!-- Submit scores to the identified groups -->
                <score-atomic score-group="group1" points="5" />
                <score-atomic score-group="group2" points="-3" />
                <!-- Event specific parameters -->
                <parameters>
                    <param name="host" value="127.0.0.1" />
                    <param name="count" value="15" />
                </parameters>
            </team-event>
            <team-event>
                <event-name name="FTP Attack" />
                <event-id id="" />
                <!-- The name of a named handler in the <event-handlers> list to dispatch this event to -->
                <handler name="metasploit-handler-1" />
                <handler-event-id guid="" />
                <!-- Time to begin and end execution relative to the game clock -->
                <starttime format="seconds" time="9" />
                <endtime format="seconds" time="9999999" />
                <!-- Possible rates include sec|min|hour;
                     drift [0.0 - 1.0] create semi-random event executions -->
                <rate scale="sec" value="5" />
                <drift value="0.0" />
                <!-- Submit scores to the identified groups -->
                <score-atomic score-group="group1" points="5" />
                <score-atomic score-group="group2" points="-3" />
                <!-- Event specific parameters -->
                <parameters>
                    <param name="host" value="10.0.0.6" />
                    <param name="port" value="22" />
                    <param name="credentials">
                    </param>
                </parameters>
            </team-event>
           
        </team-event-list>
    </team>

</occpchallenge>
